<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Criar Conta</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/style_cadastro.css">
</head>
<body class="min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-black via-green-400 via-green-700 to-blue-600 transition-colors duration-500" id="main-body">
  <div class="w-full max-w-2xl">

    <!-- Header -->
    <div class="text-center mb-8 slide-in">
      <h1 class="text-4xl font-bold text-white mb-2">Criar Conta</h1>
      <p class="text-white/80 text-lg">Junte-se a nós e comece sua jornada</p>
    </div>

    <!-- Header fixo no canto superior esquerdo -->
    <a href="site.html" class="absolute top-6 left-6 flex items-center space-x-3">
      <img src="assets/logo/Captura de tela 2025-07-29 110441.png" alt="Logo Libberpay" class="w-16 h-16 rounded-full border-4 border-green-400 shadow-xl">
      <span class="text-green-600 text-4xl font-extrabold tracking-tight font-sans uppercase drop-shadow-lg">Libberpay</span>
    </a>

    <!-- Barra de progresso -->
    <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
      <div id="progress-bar" class="bg-gradient-to-r from-purple-600 to-blue-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
    </div>

    <!-- Avatar gerado -->
    <div class="flex justify-center mb-4">
      <div id="avatar-preview" class="w-20 h-20 rounded-full bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center text-white text-3xl font-bold shadow-lg select-none"></div>
    </div>

    <!-- Form Container -->
    <div class="glass-effect rounded-2xl shadow-2xl p-8 fade-in">
      <form id="accountForm" class="space-y-6">

        <!-- Dica inteligente -->
        <div id="smart-tip" class="mb-2 text-sm text-blue-700 bg-blue-100 rounded px-3 py-2 hidden"></div>

        <!-- Nome Completo -->
        <div class="space-y-2">
          <label for="nome" class="block text-sm font-semibold ">Nome Completo</label>
          <input type="text" id="nome" name="nome" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="Digite seu nome completo">
        </div>

        <!-- Email e Telefone -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="space-y-2">
            <label for="email" class="block text-sm font-semibold text-gray-900">E-mail</label>
            <input type="email" id="email" name="email" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="seu@email.com">
          </div>
          <div class="space-y-2">
            <label for="telefone" class="block text-sm font-semibold text-gray-900">Telefone</label>
            <input type="tel" id="telefone" name="telefone" maxlength="15" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="(11) 99999-9999" />
          </div>
        </div>

        <!-- CPF e data de nascimento -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="space-y-2">
            <label for="cpf" class="block text-sm font-semibold text-gray-900">CPF</label>
            <input type="text" id="cpf" name="cpf" maxlength="14" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="000.000.000-00" />
          </div>
          <div class="space-y-2">
            <label for="dataNascimento" class="block text-sm font-semibold text-gray-900">Data de Nascimento</label>
            <input type="date" id="dataNascimento" name="dataNascimento" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" max="<?= hoje ?>">
          </div>
          <div class="space-y-2">
            <label for="idade" class="block text-sm font-semibold text-gray-900">Idade</label>
            <input type="number" id="idade" name="idade" readonly class="w-full px-4 py-3 border border-gray-200 rounded-xl bg-gray-100 cursor-not-allowed" placeholder="Idade">
          </div>
          <div class="space-y-2">
            <label for="cnpj" class="block text-sm font-semibold text-gray-900">CNPJ da Empresa</label>
            <input type="text" id="cnpj" name="cnpj" maxlength="18" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-500 input-focus" placeholder="00.000.000/0000-00" />
          </div>
        </div>

        <!-- Nome da Empresa e Estado -->
        <div class="grid grid-cols-3 gap-4">
          <div class="col-span-2 space-y-2">
            <label for="empresa" class="block text-sm font-semibold text-gray-900">Nome da Empresa</label>
            <input type="text" id="empresa" name="empresa" required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" placeholder="Digite o nome da sua empresa" />
          </div>
          <div class="space-y-2">
            <label for="estado" class="block text-sm font-semibold text-gray-900">Estado</label>
            <input type="text" id="estado" name="estado" placeholder="Digite seu estado" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 input-focus" autocomplete="off" />
            <div id="estado-suggestions" class="border border-gray-200 rounded-xl bg-white mt-1 max-h-40 overflow-y-auto hidden"></div>
          </div>
        </div>

        <!-- Campos Senha -->
        <div class="flex space-x-4">
          <div class="w-1/2">
            <label for="senha" class="block text-sm font-semibold text-gray-900">Senha</label>
            <div class="relative">
              <input type="password" id="senha" name="senha" placeholder="Digite sua senha" required class="w-full px-4 py-3 pr-10 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-500 input-focus" />
              <button type="button" id="toggle-senha" aria-label="Mostrar senha" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700">
                <svg id="icon-eye" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
                <svg id="icon-eye-off" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M3 3l18 18M10.58 10.58A3 3 0 0012 15a3 3 0 002.42-4.42M9.88 4.24A10.94 10.94 0 0112 4c7 0 11 8 11 8a17.74 17.74 0 01-3.35 4.65M6.35 6.35A17.94 17.94 0 001 12s4 8 11 8a10.9 10.9 0 004.12-.79"/>
                </svg>
              </button>
            </div>
            <!-- Barra de força da senha -->
            <div class="mt-2">
              <div class="w-full h-2 bg-gray-200 rounded">
                <div id="password-strength-bar" class="h-2 rounded transition-all duration-300" style="width:0%"></div>
              </div>
              <div id="password-strength-text" class="text-xs mt-1"></div>
            </div>
          </div>
          <div class="w-1/2">
            <label for="confirmarSenha" class="block text-sm font-semibold text-gray-900">Confirmar Senha</label>
            <div class="relative">
              <input type="password" id="confirmarSenha" name="confirmarSenha" placeholder="Confirme sua senha" required class="w-full px-4 py-3 pr-10 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-500 input-focus" />
              <p id="confirmar-senha-erro" class="text-red-500 text-xs mt-1 hidden"></p>
              <button type="button" id="toggle-confirmar" aria-label="Mostrar senha" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700">
                <svg id="icon-eye-2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
                <svg id="icon-eye-off-2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M3 3l18 18M10.58 10.58A3 3 0 0012 15a3 3 0 002.42-4.42M9.88 4.24A10.94 10.94 0 0112 4c7 0 11 8 11 8a17.74 17.74 0 01-3.35 4.65M6.35 6.35A17.94 17.94 0 001 12s4 8 11 8a10.9 10.9 0 004.12-.79"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Requisitos da Senha -->
        <ul id="senha-requisitos" class="mt-2 text-sm text-gray-700 space-y-1">
          <li id="req-tamanho" class="flex items-center"><span class="w-4 h-4 mr-2 border rounded-full"></span>Mínimo de 8 caracteres</li>
          <li id="req-maiuscula" class="flex items-center"><span class="w-4 h-4 mr-2 border rounded-full"></span>Letra maiúscula</li>
          <li id="req-minuscula" class="flex items-center"><span class="w-4 h-4 mr-2 border rounded-full"></span>Letra minúscula</li>
          <li id="req-numero" class="flex items-center"><span class="w-4 h-4 mr-2 border rounded-full"></span>Número</li>
          <li id="req-simbolo" class="flex items-center"><span class="w-4 h-4 mr-2 border rounded-full"></span>Pelo menos 1 símbolo (!@#$%^&*)</li>
        </ul>

        <!-- Aceite dos Termos -->
        <div class="flex items-start space-x-3 p-4 bg-gray-50 rounded-xl">
          <input type="checkbox" id="termos" name="termos" required class="mt-1 h-5 w-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500">
          <label for="termos" class="text-sm text-gray-700 leading-relaxed">
            Eu concordo com os <a href="#" class="text-purple-600 hover:text-purple-800 font-semibold">Termos de Uso</a> e 
            <a href="#" class="text-purple-600 hover:text-purple-800 font-semibold">Política de Privacidade</a>. 
            Confirmo que tenho pelo menos 18 anos de idade.
          </label>
        </div>

        <!-- Botão de Envio -->
        <button type="submit" id="btn-submit" class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-4 px-6 rounded-xl hover:from-purple-700 hover:to-blue-700 transition-all duration-300 btn-hover shadow-lg flex items-center justify-center gap-2">
          <span id="btn-submit-text">Criar Minha Conta</span>
          <svg id="btn-loading" class="animate-spin h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8z"></path>
          </svg>
        </button>

        <!-- Link para Login -->
        <div class="text-center pt-4">
          <p class="text-gray-600">
            Já tem uma conta? 
            <a href="login.html" class="text-purple-600 hover:text-purple-800 font-semibold transition-colors duration-200">Faça login aqui</a>
          </p>
        </div>
      </form>
    </div>

    <!-- Footer -->
    <div class="text-center mt-6">
      <p class="text-white/60 text-sm">© 2024 Sua Empresa. Todos os direitos reservados.</p>
    </div>
  </div>

  <!-- Modal de verificação (NOVO) -->
  <div id="verify-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white w-full max-w-md rounded-lg p-6 shadow-lg relative">
      <button id="verify-close" class="absolute right-3 top-3 text-gray-500 hover:text-gray-700" aria-label="Fechar">✕</button>
      <h2 class="text-xl font-semibold mb-2">Conta criada!</h2>
      <p class="text-sm text-gray-600 mb-4">
        Enviamos um código de verificação para <span id="verify-email" class="font-medium"></span>.
        Digite o código de 6 dígitos abaixo para confirmar seu e-mail.
      </p>
      <div class="mb-3">
        <label for="verify-code" class="block text-sm font-medium mb-1">Código</label>
        <input id="verify-code" type="text" inputmode="numeric" maxlength="6"
               class="w-full border rounded px-3 py-2" placeholder="Ex: 123456" />
        <div id="verify-error" class="text-sm text-red-600 mt-1 hidden"></div>
        <div id="verify-success" class="text-sm text-green-600 mt-1 hidden"></div>
      </div>
      <div class="flex items-center gap-2">
        <button id="verify-submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50">
          Verificar
        </button>
        <button id="verify-resend" class="text-blue-600 hover:underline" type="button">
          Reenviar código
        </button>
        <span id="resend-timer" class="text-sm text-gray-500 ml-auto"></span>
      </div>
    </div>
  </div>

  <!-- Modal de E-mail Já Cadastrado -->
  <div id="email-exists-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50">
    <div class="bg-white w-full max-w-md rounded-lg p-6 shadow-lg relative flex flex-col items-center">
      <button id="email-exists-close" class="absolute right-3 top-3 text-gray-500 hover:text-gray-700" aria-label="Fechar">✕</button>
      <h2 class="text-xl font-semibold mb-2 text-center text-red-600">E-mail já cadastrado</h2>
      <p class="text-gray-700 text-center mb-6">
        Este e-mail já possui uma conta na Libberpay.<br>
        Se já é cadastrado, faça login para acessar sua conta.
      </p>
      <div class="flex gap-3 w-full">
        <a href="login.html" class="flex-1 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold py-2 rounded-xl text-center hover:from-purple-700 hover:to-blue-700 transition-all duration-300 shadow">
          Ir para Login
        </a>
        <button id="email-exists-close-btn" class="flex-1 border border-gray-300 text-gray-700 py-2 rounded-xl hover:bg-gray-100 transition-all duration-200">
          Fechar
        </button>
      </div>
    </div>
  </div>

  <!-- Confete animado -->
  <canvas id="confetti-canvas" class="fixed inset-0 pointer-events-none z-[9999]" style="display:none"></canvas>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.31.0/dist/umd/supabase.min.js"></script>
  <!-- Seu JS principal -->
  <script src="js/form_cadastro.js" defer></script>
</body>
</html>